{% extends 'base.html' %}

{% block content %}
<div class="container py-5">
    <h1 class="mb-4 fw-bold"><i class="fa-solid fa-cart-shopping me-2"></i>Tu Carrito</h1>

    {% if cart_items %}
    <div class="row">
        <!-- Tabla de Productos -->
        <div class="col-lg-8">
            <div class="card shadow-sm border-0 mb-4">
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0">
                        <thead class="bg-light">
                            <tr>
                                <th>Producto</th>
                                <th>Precio</th>
                                <th>Cantidad</th>
                                <th>Subtotal</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for item in cart_items %}
                            <tr>
                                <td>
                                    <div class="d-flex align-items-center">
                                        <img src="{{ item.image }}" alt="{{ item.title }}"
                                            style="width: 50px; height: 50px; object-fit: contain;" class="me-3">
                                        <span class="small fw-bold text-truncate" style="max-width: 200px;">{{
                                            item.title }}</span>
                                    </div>
                                </td>
                                <td>${{ item.price }}</td>
                                <td>
                                    <span class="badge bg-secondary px-3 py-2">{{ item.quantity }}</span>
                                </td>
                                <td class="fw-bold">${{ item.subtotal|stringformat:".2f" }}</td>
                                <td class="text-end">
                                    <a href="{% url 'remove_from_cart' item.id %}"
                                        class="btn btn-sm btn-outline-danger">
                                        <i class="fa-solid fa-trash"></i>
                                    </a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            <a href="{% url 'get_products' %}" class="btn btn-link text-decoration-none p-0">
                <i class="fa-solid fa-arrow-left me-2"></i>Continuar comprando
            </a>
        </div>

        <!-- Resumen del Pedido -->
        <div class="col-lg-4">
            <div class="card shadow-sm border-0 p-4">
                <h4 class="fw-bold mb-4">Resumen</h4>
                <div class="d-flex justify-content-between mb-2">
                    <span>Subtotal</span>
                    <span>${{ total|stringformat:".2f" }}</span>
                </div>
                <div class="d-flex justify-content-between mb-4">
                    <span>Envío</span>
                    <span class="text-success fw-bold">Gratis</span>
                </div>
                <hr>
                <div class="d-flex justify-content-between mb-4">
                    <span class="h5 fw-bold">Total</span>
                    <span class="h5 fw-bold text-primary">${{ total|stringformat:".2f" }}</span>
                </div>
                <button class="btn btn-primary w-100 py-3 fw-bold">
                    Finalizar Compra
                </button>
            </div>
        </div>
    </div>
    {% else %}
    <div class="text-center py-5">
        <i class="fa-solid fa-cart-arrow-down display-1 text-muted mb-4"></i>
        <p class="lead">Tu carrito está vacío.</p>
        <a href="{% url 'get_products' %}" class="btn btn-primary px-5 py-3">Ir a la tienda</a>
    </div>
    {% endif %}
</div>
{% endblock %}